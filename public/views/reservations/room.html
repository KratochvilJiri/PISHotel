<!-- new user form -->

<div class="ui attached message">
    <div class="header">
        Rezervace
    </div>
</div>
<form class="ui form attached fluid segment">
    <div class="field">
        <div class="ui floating labeled icon dropdown button">
            <i class="user icon"></i>
            <span class="text">Volba zákazníka</span>
            <div class="menu">
                <div class="item"  ng-click="reservation.disNewCust = true">
                    <i class="add user icon"></i> Vytvořit nového zákazníka
                </div>
                <div class="divider"></div>
                <div class="header">
                    Vyhledat zákazníka
                </div>
                <div class="ui left icon input">
                    <i class="search icon"></i>
                    <input type="text" name="search" ng-model="customerSearch" placeholder="Search...">
                </div>
                <div ng-click="setCustomer(customer)" ng-repeat="customer in customers | filter:customerSearch | limitTo:9" class="item">
                    {{customerToString(customer)}}
                </div>
            </div>
        </div>
    </div>
    
    <fieldset class="nestForm" ng-if="reservation.disNewCust" style="border:3px solid grey; border-radius: 25px; padding: 20px; margin-bottom:15px;">
      <legend>Nový zákazník</legend>
       <div class="two fields">
       <div class="field">
         <label>Jméno</label>
            <input placeholder="Jméno" type="text" ng-model="reservation.newCustomerName">
        </div>
        <div class="field">
            <label>Číslo OP</label>
            <input placeholder="Číslo OP" type="text" ng-model="reservation.newCustomerID">
        </div>
      </div>
      <div class="field">
        <label>Adresa</label>
        <textarea rows="4" ng-model="reservation.newCustomerAdress"></textarea>
      </fieldset>
      
    <div class="two fields">
        <div class="field">
            <label>Počet dospelých</label>
            <input placeholder="Počet dospelých" type="number" ng-model="reservation.numberOfAdults">
        </div>
        <div class="field">
            <label>Počet dětí</label>
            <input placeholder="Počet dětí" type="number" ng-model="reservation.numberOfChildren">
        </div>
    </div>
    <div class="two fields">
        <div class="field">
            <label>Datum začátku pobytu</label>
            <input type="date" ng-model="reservation.dateFrom" format-date>
        </div>
        <div class="field">
            <label>Datum konce pobytu</label>
            <input type="date" ng-model="reservation.dateTo" format-date>
        </div>
    </div>
    <div class="field">
        <label>Pokoj</label>
        <select ng-options="(item.ID + ' ' + item.roomType.name) for item in rooms track by item._id"
        ng-model="reservation.room">
            <option disabled value="">Vyberte pokoj</option>
        </select>
    </div>
    <div class="two fields">
        <div class="field">
            <label>Typ penze</label>
            <select ng-options="item.name for item in pensionTypes track by item.code" class="ui dropdown"
            ng-model="reservation.pensionType">
                <option value="">Vyberte penzi</option>
            </select>
        </div>
        <div class="field">
            <label>Způsob platby</label>
            <select ng-options="item.name for item in paymentTypes track by item.code" class="ui dropdown" ng-model="reservation.paymentType">
                <option value="">Vyberte způsob platby</option>
            </select>
        </div>
    </div>
</form>
<div class="ui attached message">
    <div class="header">
        Služby
    </div>
</div>
<table class="ui celled attached striped table">
    <thead>
        <tr>
            <th>Název služby</th>
            <th>Počet</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td class="editable">
                <select ng-options="item.name for item in services" class="ui dropdown" ng-model="newReservationService.service">
                    <option value="">Vyberte službu</option>
                </select>
            </td>
            <td class="editable">
                <input type="number" ng-model="newReservationService.count" placeholder="Zadejte počet" />
            </td>
            <td>
                <a class="ui basic button" ng-click="addService(newReservationService)">
                    <i class="save icon"></i> Vložit
                </a>
            </td>
        </tr>
        <tr ng-repeat="service in reservation.services">
            <td class="editable">
                {{service.service.name}}
            </td>
            <td class="editable">
                <input type="number" ng-model="service.count" placeholder="Zadejte počet" />
            </td>
            <td>
                <a class="ui basic button" ng-click="removeService($index)">
                    <i class="remove red icon"></i> Smazat
                </a>
            </td>
        </tr>
    </tbody>
</table>
<div ng-if="reservation.calculation" class="ui attached message">
    <div class="header">
        Kalkulace
    </div>
</div>
<table ng-if="reservation.calculation" class="ui celled attached striped table calculation">
    <thead>
        <tr>
            <th>Název</th>
            <th>Počet</th>
            <th>Cena za položku</th>
            <th>Suma</th>
        </tr>
    </thead>
    <tbody>
        <tr ng-repeat="item in reservation.calculation.items">
            <td>{{item.name}}</td>
            <td>{{item.count}}</td>
            <td>{{item.price}}</td>
            <td class="align-right">{{item.sum}}</td>
        </tr>
        <tr>
            <td class="bold" colspan="3">Celkem</td>
            <td class="bold align-right">{{item.sum}}</td>
        </tr>
    </tbody>
</table>
<div class="ui bottom attached message">
    <a ng-click="save()" class="ui button fontWhite BGOrange">
        <i class="save icon"></i> Uložit
    </a>
    <span ng-if="reservation._id">
        <a ng-click="reservationStateChanged(1)" class="ui button fontWhite BGOrange" ng-if="reservation.state == 0">
            <i class="check circle outline icon"></i> Potvrdit
        </a>
        <a ng-click="reservationStateChanged(2)" class="ui button fontWhite BGOrange" ng-if="reservation.state == 0">
            <i class="remove circle icon"></i> Stornovat
        </a>
        <a ng-click="reservationStateChanged(3)" class="ui button fontWhite BGOrange" ng-if="reservation.state == 1">
            <i class="calculator icon"></i> Kalkulovat
        </a>
        <a ng-click="reservationStateChanged(4)" class="ui button fontWhite BGOrange" ng-if="reservation.state == 3">
            <i class="dollar icon"></i> Potvrdit platbu
        </a>
    </span>
</div>